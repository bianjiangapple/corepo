This is the fixes for issue 2.

Changes are welcome!
